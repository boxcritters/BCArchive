var client=client||{};!function(){function t(){this.rooms=[],this.items=[],this.critters=[],this.mascots=[],this.effects=[]}t.prototype.getRooms=function(){return this.rooms},t.prototype.getRoom=function(t){return common.findObjectInArray("roomId",t,this.rooms)},t.prototype.getItems=function(t){return this.items},t.prototype.getItem=function(t){return common.findObjectInArray("itemId",t,this.items)},t.prototype.getCritter=function(t){return common.findObjectInArray("critterId",t,this.critters)},client.Artwork=t}(),client=client||{},function(){function t(t){t&&t.playerId&&t.nickname&&t.critterId&&(this.playerId=t.playerId,this.nickname=t.nickname,this.critterId=t.critterId,this.inventory=t.inventory||[],this.gear=t.gear||[],this.eggs=t.eggs||[],this.coins=t.coins||0,this.isMember=t.isMember||!1,this.isGuest=t.isGuest||!1,this.isTeam=t.isTeam||!1)}t.prototype.getPlayerId=function(){return localStorage.getItem("playerId")},t.prototype.updateGear=function(t){this.gear=t},t.prototype.addItem=function(t){this.hasItem(t)||this.inventory.unshift(t)},t.prototype.hasItem=function(t){for(var e=this.inventory.length,i=0;i<e;i++)if(this.inventory[i]===t)return!0},t.prototype.addEgg=function(t){this.eggs.push(t)},t.prototype.isLocal=function(t){if(this.playerId===t)return!0},client.Player=t}(),client=client||{},function(){function t(t){t&&t.roomId&&(t.playerCrumbs,t.triggers,this.roomId=t.roomId,this.name=t.name,this.playerCrumbs=t.playerCrumbs||[],this.triggers=t.triggers||[])}t.prototype.addPlayerCrumb=function(t){this.playerCrumbs.push(t)},t.prototype.removePlayerCrumb=function(t){common.removeObjectInArray("i",t.i,this.playerCrumbs)},t.prototype.updatePlayerCrumb=function(t){var e=common.findObjectInArray("i",t.i,this.playerCrumbs);e&&(e.g=t.g||e.g,e.x=t.x||e.x,e.y=t.y||e.y,e.r=t.r||e.r,e.m=t.m||e.m,e.e=t.e||e.e)},client.Room=t}(),client=client||{},function(){function t(){this._events={},this.stage,this.player,this.room,this.socket,this.autoJoinLobby=!1,this.autoConnect=!1,this.settings={},this.artwork=new client.Artwork}t.prototype.addSocket=function(t){this.socket=t},t.prototype.addStage=function(t){t&&(this.stage=new client.StageContainer(t,this),this.stage.listen(this),this.stage.on("roomClick",(function(t){this.moveTo(t.x,t.y)}),this),this.stage.on("trigger",(function(t){world.trigger(t.x,t.y)})))},t.prototype.loadManifest=function(t){var e=new createjs.LoadQueue(!0);e.loadManifest(t),e.on("complete",(function(t){let i=e.getResult("critters")||[],n=e.getResult("mascots")||[];this.artwork.critters=i.concat(n),this.artwork.items=e.getResult("items")||[],this.artwork.rooms=e.getResult("rooms")||[],this.artwork.media=e.getResult("media")||[],this.artwork.menu=e.getResult("menu")||[],this.emit("ready")}),this)},t.prototype.connect=function(){this.socket&&this.socket.open()},t.prototype.login=function(t){var e=this.socket;e.on("connect",(function(){e.emit("login",t)})),this.handleSocket(e),e.open()},t.prototype.guest=function(){var t=this.socket;t.on("connect",(function(){t.emit("guest")})),this.handleSocket(t),t.open()},t.prototype.cheerio=function(){this.socket&&(this.socket.disconnect(),this.emit("cheerio"))},t.prototype.disconnect=function(){this.socket&&this.socket.disconnect()},t.prototype.joinLobby=function(){this.socket&&this.socket.emit("joinLobby")},t.prototype.joinRoom=function(t){this.socket&&this.artwork.getRoom(t)&&this.socket.emit("joinRoom",t)},t.prototype.handleSocket=function(t){var e=this;t.on("connect",(function(){e.emit("connect")})),t.on("disconnect",(function(){e.emit("disconnect")})),t.on("login",(function(i){let n=i.playerId;e.player=new client.Player(i),e.emit("login",i),localStorage.setItem("playerId",n),setInterval((function(){e.player.getPlayerId()!=n&&t&&t.disconnect()}),1e4),e.autoJoinLobby&&e.joinLobby()})),t.on("beep",(function(t){e.emit("beep",t)})),t.on("darkmode",(function(){e.emit("darkmode")})),t.on("joinRoom",(function(t){e.room=new client.Room(t),e.emit("joinRoom",t)})),t.on("updateGear",(function(t){e.player.updateGear(t),e.emit("updateGear",t);var i={i:e.player.playerId,g:e.player.gear};e.room.updatePlayerCrumb(i),e.emit("G",i)})),t.on("addItem",(function(t){e.player.addItem(t),e.emit("addItem",t)})),t.on("addEgg",(function(t){e.player.addEgg(t),e.emit("addEgg",t)})),t.on("A",(function(t){e.room.addPlayerCrumb(t),e.emit("A",t)})),t.on("R",(function(t){e.room.removePlayerCrumb(t),e.emit("R",t)})),t.on("G",(function(t){e.room.updatePlayerCrumb(t),e.emit("G",t)})),t.on("X",(function(t){e.room.updatePlayerCrumb(t),e.emit("X",t)})),t.on("J",(function(t){e.room.updatePlayerCrumb(t),e.emit("J",t)})),t.on("M",(function(t){e.room.updatePlayerCrumb(t),e.emit("M",t)})),t.on("E",(function(t){e.room.updatePlayerCrumb(t),e.emit("E",t)}))},t.prototype.isLocalPlayer=function(t){if(this.player)return this.player.isLocal(t)},t.prototype.command=function(t){if("/"===(t=t.trim()).substr(0,1)){let e=t.substr(1).split(" "),i=e.shift();if("gear"===i)return this.updateGear(e);if("join"===i)return this.joinRoom(e[0]);if("emote"===i)return this.emote(e[0]);if("nicknames"===i)return this.emit("toggleNicknames");if("balloons"===i)return this.emit("toggleBalloons");if("darkmode"===i)return this.socket.emit("code","darkmode"),this.emit("darkmode");if("pop"===i)return this.socket.emit("pop");if("game"===i)return showGame();if("shop"===i)return this.emit("showShop");this.socket.emit("code",i)}},t.prototype.message=function(t){"/"===(t=t.trim()).substr(0,1)?this.command(t):(this.socket&&this.socket.emit("message",t),this.emit("M",{i:this.player.playerId,n:this.player.nickname,m:t}))},t.prototype.emote=function(t){this.socket&&this.socket.emit("emote",t),this.emit("E",{i:this.player.playerId,e:t})},t.prototype.moveTo=function(t,e){this.socket&&this.socket.emit("moveTo",t,e)},t.prototype.jumpTo=function(t,e){this.socket&&this.socket.emit("jumpTo",t,e)},t.prototype.updateGear=function(t){this.socket&&this.socket.emit("updateGear",t)},t.prototype.trigger=function(t,e){let i;this.stage&&this.stage.room&&(i=this.stage.room.getTrigger(t,e)||{},i.player,i.room&&this.stage.room.handleTrigger(i.room),i.world&&this.handleTrigger(i.world)),this.socket&&this.socket.emit("trigger")},t.prototype.handleTrigger=function(t){t.joinRoom&&this.joinRoom(t.joinRoom)},t.prototype.on=function(t,e){"object"!=typeof this._events[t]&&(this._events[t]=[]),this._events[t].push(e)},t.prototype.emit=function(t){var e,i,n,o=[].slice.call(arguments,1);if("object"==typeof this._events[t])for(n=(i=this._events[t].slice()).length,e=0;e<n;e++)i[e].apply(this,o)},client.World=t}();var box=box||{};!function(){function t(t,e){createjs.Container.call(this);let i=new box.Style(e),n=20,o=new createjs.Text(t,i.font,i.fontColor).setTransform(20,n);o.snapToPixel=!0,o.lineWidth=280,n+=o.getBounds().height,n+=20;let s=new createjs.Shape;s.graphics.beginFill(i.fill).drawRoundRect(0,0,360,n,i.radius),s.shadow=new createjs.Shadow("rgba(0, 0, 0, 0.8)",0,2,4);let r=(new box.Close).setTransform(310,10);return this.addChild(s,o,r),this.on("click",(function(){handleClick?handleClick():this.parent.removeChild(this)}),this),this.on("added",(function(){}),this),this}t.prototype=Object.create(createjs.Container.prototype),box.Alert=t}(),box=box||{},function(){function t(t,e){createjs.Container.call(this);let i=new box.Style(e),n=new createjs.Text(t,i.font,i.fontColor).setTransform(5,5),o=n.getBounds(),s=o.width+10,r=o.height+10;var a=new createjs.Shape;return a.graphics.beginFill(i.fill).drawRoundRect(0,0,s,r,5,5,5,5),this.addChild(a,n),this.on("added",(function(){}),this),this}t.prototype=Object.create(createjs.Container.prototype),box.Badge=t}(),box=box||{},function(){function t(t,e){return createjs.Container.call(this),this.w=t,this.h=e,this.on("added",(function(){}),this),this}function e(t,e){t&&e&&t.setTransform(e.x,e.y,e.scaleX,e.scaleY,e.rotation,e.skewX,e.skewY,e.regX,e.regY)}t.prototype=Object.create(createjs.Container.prototype),t.prototype.addSprite=function(t,i,n){let o=new createjs.Sprite(t,i);return e(o,n),this.addChild(o),this},t.prototype.addImage=function(t,i){let n=new createjs.Bitmap(t);return e(n,i),this.style=i,this.addChild(n),this},t.prototype.addTitle=function(t,i){let n=new box.Title(t,i);return e(n,i),this.addChild(n),this},box.Card=t}(),box=box||{},function(){function t(){createjs.Container.call(this);let t=new createjs.Bitmap("/images/icons/close.png").setTransform(0,0,.5,.5);return this.addChild(t),this}t.prototype=Object.create(createjs.Container.prototype),box.Close=t}(),box=box||{},function(){function t(t){createjs.Container.call(this);let e=t.getBounds(),i=e.width,n=e.height,o=new createjs.Graphics;o.beginFill("black"),o.drawRect(0,0,i,n);let s=new createjs.Shape(o);return s.alpha=.7,s.on("click",(function(){this.parent.removeChild(this)}),this),this.addChild(s),this}t.prototype=Object.create(createjs.Container.prototype),box.Modal=t}(),box=box||{},function(){let t={primary:{fill:"#007bff",text:"#ffffff"},secondary:{fill:"#6c757d",text:"#ffffff"},success:{fill:"#28a745",text:"#ffffff"},warning:{fill:"#ffc107",text:"#212529"},danger:{fill:"#dc3545",text:"#ffffff"},light:{fill:"#f8f9fa",text:"#212529"},dark:{fill:"#343a40",text:"#ffffff"}};function e(e){createjs.Container.call(this),"string"==typeof(e=e||{})&&(e={theme:e}),this.theme=e.theme||"primary",this.fontSize=e.fontSize||16,this.fontName=e.fontName||"Arial",this.fontColor=e.fontColor||t[this.theme].text,this.font=this.fontSize+"px "+this.fontName,this.fill=e.fill||t[this.theme].fill,this.radius=e.radius||4,this.lineWidth=e.lineWidth,this.textAlign=e.textAlign}e.prototype=Object.create(createjs.Container.prototype),box.Style=e}(),box=box||{},function(){function t(t,e){createjs.Container.call(this);let i=new box.Style(e),n=new createjs.Text(t,i.font,i.fontColor).setTransform(5,5);n.lineWidth=e.lineWidth,n.textAlign=e.textAlign;let o=n.clone();return o.color=i.fill,o.outline=4,this.addChild(o,n),this.on("added",(function(){}),this),this}t.prototype=Object.create(createjs.Container.prototype),box.Title=t}(),box=box||{},function(){function t(){return createjs.Container.call(this),this.on("added",(function(){}),this),this}t.prototype=Object.create(createjs.Container.prototype),box.Grid=t}(),box=box||{},function(){function t(){return createjs.Container.call(this),this.on("added",(function(){}),this),this}t.prototype=Object.create(createjs.Container.prototype),box.Grid=t}(),client=client||{},function(){function t(t,e){createjs.Container.call(this),this.height=20;var i=new createjs.Text(t,"16px Arial","#212529");i.snapToPixel=!0,i.setTransform(20,this.height),i.lineWidth=280;var n=i.getBounds();this.height+=n.height,this.addChild(i),this.height+=20;let o=new createjs.Shape;o.graphics.beginFill("#f8f9fa").drawRoundRect(0,0,360,this.height,4),o.shadow=new createjs.Shadow("rgba(0, 0, 0, 0.8)",0,2,4),this.addChildAt(o,0);var s=new client.Image("/images/icons/close.png");s.setTransform(310,10,.5,.5),this.on("click",(function(){e?e():this.parent.removeChild(this)}),this),this.addChild(s)}t.prototype=Object.create(createjs.Container.prototype),t.prototype.center=function(t,e){let i=t||this.parent.width,n=e||this.parent.height;this.x=i/2-180,this.y=n/2-this.height/2},client.Alert=t}(),client=client||{},function(){function t(t){createjs.Container.call(this);var e=new createjs.Text(t,"16px Arial","#ffffff");e.textBaseline="middle",e.x=16,e.y=20,e.snapToPixel=!0;var i=e.getBounds(),n=Math.floor(i.width)+32,o=new createjs.Shape;o.graphics.beginFill("#007bff").drawRoundRect(0,0,n,36,4),this.addChild(o,e),this.setBounds(0,0,n,36)}t.prototype=Object.create(createjs.Container.prototype),client.Button=t}(),client=client||{},function(){function t(t,e,i,n,o){createjs.Container.call(this),this.setBounds(2,2,t,e),this.width=t,this.height=e,this.columns=i,this.rows=n,this.tileWidth=Math.floor(t/i),this.tileHeight=Math.floor(e/n),this.lastTileX=0,this.lastTileY=0,this.maxItems=this.columns*this.rows,this.currentPage=0,o&&Array.isArray(o)?(this.list=o,this.update()):this.list=[]}t.prototype=Object.create(createjs.Container.prototype),t.prototype.update=function(t){this.removeAllChildren();for(var e=t||0,i=0;i<this.rows;i++)for(var n=0;n<this.columns;n++){var o=this.list[e];o&&(o.x=n*this.tileWidth,o.y=i*this.tileHeight,this.addChild(o),this.lastTileX=n,this.lastTileY=i),e++}},t.prototype.updateList=function(t){this.list=t,this.update(this.currentPage*this.maxItems)},t.prototype.addItem=function(t){this.list.push(t),this.update(this.currentPage*this.maxItems)},t.prototype.nextPage=function(){var t=Math.floor(this.list.length/this.maxItems),e=this.currentPage+1;e<=t&&(this.currentPage=e,this.update(e*this.maxItems))},t.prototype.lastPage=function(){var t=this.currentPage-1;t>=0&&(this.currentPage=t,this.update(t*this.maxItems))},client.Grid=t}(),client=client||{},function(){function t(t,e){createjs.Container.call(this),this.isActive=e,this.image=new createjs.Bitmap("/media/icons/"+t+".png"),this.active=new createjs.Bitmap("/images/frames/item_active.png"),this.active.visible=this.isActive,this.background=new createjs.Bitmap("/images/frames/item.png"),this.addChild(this.background,this.active,this.image)}t.prototype=Object.create(createjs.Container.prototype),t.prototype.updateActive=function(t){this.isActive=t,this.active.visible=t},client.Icon=t}(),client=client||{},function(){function t(t){createjs.Container.call(this);let e=new createjs.Bitmap(t);this.addChild(e)}t.prototype=Object.create(createjs.Container.prototype),client.Image=t}(),client=client||{},function(){function t(t,e,i){createjs.Container.call(this);let n=i.inventory,o=i.gear;var s=new createjs.Graphics;s.beginFill("black"),s.drawRect(0,0,t,e);var r=new createjs.Shape(s);r.alpha=.7,r.on("click",(function(){})),this.addChild(r);let a=i.critterId,c=new client.BitContainer(a,"md");for(let t=0;t<i.gear.length;t++){let e=i.gear[t],n=world.artwork.getItem(e);c.addItem(n)}this.addChild(c).setTransform(540,20);let h=[],l={};n.forEach((function(t){let e=world.artwork.getItem(t);if(e){let i=o.includes(t),n=new client.Icon(e.itemId,i);n.itemId=e.itemId,n.setTransform(0,0,.5,.5),n.on("click",(function(){n.isActive?(n.updateActive(!1),function(t){o=common.removeValueFromArray(o,t.itemId),delete l[t.slot],c.removeItem(t)}(e)):(n.updateActive(!0),function(t,e){let i=l[t.slot];i&&(o=common.removeValueFromArray(o,i.itemId),i.updateActive(!1)),l[t.slot]=e,o.push(t.itemId),c.addItem(t)}(e,n))})),i&&(l[e.slot]=n),h.push(n)}}));var d=new client.Grid(600,400,6,4,h);d.setTransform(20,20),this.addChild(d);var p=new client.Image("/images/icons/close.png");p.setTransform(790,20,.5,.5),p.on("click",(function(){this.stage.world.updateGear(o),this.parent.removeChild(this)}),this),this.addChild(p);var u=new client.Button("Next Page");u.setTransform(140,420),u.on("click",(function(){d.nextPage()})),this.addChild(u);var m=new client.Button("Last Page");m.setTransform(20,420),m.on("click",(function(){d.lastPage()})),this.addChild(m)}t.prototype=Object.create(createjs.Container.prototype),client.Inventory=t}(),client=client||{},function(){function t(t){createjs.Container.call(this),this.name=t.name;let e=convertToImgElement(t.image),i=new createjs.Bitmap(e);this.body=new createjs.Text("","60px Luckiest Guy","#FFC636"),this.body.setTransform(100,32),this.addChild(i,this.body)}t.prototype=Object.create(createjs.Container.prototype),t.prototype.updateText=function(t){this.body.text=t},client.Widget=t}(),box=box||{},function(){function t(t){createjs.Container.call(this);let e=t.width,i=t.height;this.width=e,this.height=i;var n=new createjs.Graphics;n.beginFill("black"),n.drawRect(0,0,e,i);var o=new createjs.Shape(n);o.alpha=.7;let s=new client.Alert("Disconnected from Box Critters",(function(){location.reload()}));s.center(e,200),this.addChild(o,s)}t.prototype=Object.create(createjs.Container.prototype),box.Cheerio=t}(),box=box||{},function(){function t(t){createjs.Container.call(this),t.width,t.height,this.regX=18,this.regY=18;var n=new createjs.LoadQueue(!1);n.loadFile({id:"ss",src:"/media/shops/pirate.json",type:createjs.Types.SPRITESHEET,crossOrigin:!0}),n.on("complete",(function(t){let o=n.getResult("ss"),s=new createjs.Sprite(o,"ShopPort_BG_Window_Full"),r=new createjs.Sprite(o,"ShopPort_BG_Featured_Full2").setTransform(0,250),a=new createjs.Sprite(o,"ShopPort_BG_Default_Full2").setTransform(0,415),c=e(o,"Featured Items").setTransform(0,230),h=e(o,"Coming Soon").setTransform(0,396),l=i(o,{itemId:"pirate_crew_blue",icon:"/media/icons/pirate_crew_blue.png",background:"ShopPort_Item_A_Previous",cost:200}).setTransform(25,270),d=i(o,{itemId:"clown_wig",icon:"/media/icons/clown_wig.png",background:"ShopPort_Item_A_Current",hasGlow:!0,message:"Free Item"}).setTransform(145,270);d.on("click",(function(){}),this);let p=i(o,{itemId:"clown_suit_red",icon:"/media/icons/clown_suit_red.png",frame:"ShopPort_Item_A_ComingSoon",message:"Next Week"}).setTransform(265,270);this.addChild(s,r,a,c,h,l,p,d);let u=[{itemId:"beard3_red",icon:"/media/icons/beard3_red.png",cost:20},{itemId:"pirate_crew_green",icon:"/media/icons/pirate_crew_green.png",cost:200},{itemId:"pirate_bandana_pink",icon:"/media/icons/pirate_bandana_pink.png",cost:100},{itemId:"backpack_green",icon:"/media/icons/backpack_green.png",cost:1e3},{itemId:"fedora_black",icon:"/media/icons/fedora_black.png",cost:50},{itemId:"plaid_pink",icon:"/media/icons/plaid_pink.png",cost:200}],m=0;for(let t=0;t<2;t++)for(let e=0;e<3;e++){let n=i(o,{icon:u[m].icon,frame:"ShopPort_Item_B_Default",cost:u[m].cost}).setTransform(25+120*e,440+120*t);this.addChild(n),m++}}),this)}function e(t,e){let i=new createjs.Container,n=new createjs.Sprite(t,"ShopPort_BarTitle_Full"),o=new box.Title(e,{fontSize:20,fontName:"Luckiest Guy",fill:"#000000"},!0).setTransform(40,10);return i.addChild(n,o),i}function i(t,e){e.background=e.background||"ShopPort_Item_B_Default";let i=new box.Card(120,120);return e.hasGlow&&i.addSprite(t,"ShopPort_Item_Glow",{x:-42,y:-42},1),i.addSprite(t,e.background,{x:7,y:7}).addImage(e.icon,{x:20,y:24,scaleX:.5,scaleY:.5}),e.cost?i.addSprite(t,"ShopPort_Item_TagCost",{x:7,y:7}).addTitle(e.cost,{theme:"dark",fontName:"Luckiest Guy",fontColor:"#FFC636",fontSize:24,lineWidth:110,x:40,y:85}):i.addSprite(t,"ShopPort_Item_TagBlank",{x:7,y:7}).addTitle(e.message,{theme:"dark",fontName:"Luckiest Guy",textAlign:"center",x:57,y:90}),i}t.prototype=Object.create(createjs.Container.prototype),box.Shop=t}();var common=common||{};function convertToImage(t){var e=document.createElement("img");return e.crossOrigin="Anonymous",e.src=t,e}function convertToImgElement(t){if("string"==typeof t){var e=document.createElement("img");return e.crossOrigin="Anonymous",e.src=t,e}return t}function convertToImgElements(t){if(Array.isArray(t)){for(var e=[],i=0;i<t.length;i++)e.push(convertToImgElement(t[i]));return e}}common.getRandomItem=function(t){return t[Math.floor(Math.random()*t.length)]},common.calculateDistance=function(t,e,i,n){var o=i-t,s=n-e;return Math.sqrt(o*o+s*s)},common.calculateAngle=function(t,e,i,n){var o=i-t,s=e-n,r=Math.atan2(o,s),a=Math.floor(180*r/Math.PI);return a<0?a+360:a},common.getDirection=function(t){var e=Math.floor((t+22.5)/45);return e>7?0:e},common.isArraysEqual=function(t,e){if(t===e)return!0;if(null==t||null==e)return!1;if(t.length!==e.length)return!1;for(var i=0;i<t.length;++i)if(t[i]!==e[i])return!1;return!0},common.removeValueFromArray=function(t,e){return t.filter((function(t){return t!==e}))},common.removeDuplicatesInArray=function(t){return unique=t.filter((function(t,e,i){return e===i.indexOf(t)}))},common.timestamp=function(){return(new Date).getTime()},common.removeDuplicates=function(t,e){var i={};return t.filter((function(t){if(!i[t[e]])return i[t[e]]=!0,t}))},common.arrayToObject=function(t,e){for(var i={},n=t.length,o=0;o<n;o++)i[t[o][e]]=t[o];return i},common.findObjectInArray=function(t,e,i){for(var n=i.length,o=0;o<n;o++)if(i[o][t]==e)return i[o]},common.removeObjectInArray=function(t,e,i){for(var n=i.length,o=0;o<n;o++)if(i[o][t]==e){var s=i[o];return i.splice(o,1),s}},client=client||{},function(){function t(){this.ss={},this._loadQueue={}}t.prototype.load=function(t,e){if(this.ss[t])return void e(this.ss[t]);if(this._loadQueue[t])return void this._loadQueue[t].push(e);this._loadQueue[t]=[e];let i=new createjs.LoadQueue(!1);i.loadFile({src:t,type:createjs.Types.SPRITESHEET,crossOrigin:!0}),i.on("complete",(function(e){let n=i.getResult(t);this.ss[t]=n,length=this._loadQueue[t].length;for(let e=0;e<length;e++)this._loadQueue[t][e](n);delete this._loadQueue[t]}),this)},client.SpriteSheet=new t}(),client=client||{},function(){function t(t){createjs.Container.call(this),t&&(this.x=t.x,this.y=t.y)}function e(t,e){var i=e+20,n=t+20,o=new createjs.Shape;return o.graphics.setStrokeStyle(1).beginStroke("#888888").beginFill("#FFFFFF"),o.graphics.moveTo(5,0).arcTo(n,0,n,5,5).arcTo(n,i,n-5,i,5).lineTo(80,i).lineTo(70,i+10).lineTo(70,i).arcTo(0,i,0,i-5,5).arcTo(0,0,5,0,5),o.x=0-n/2,o.y=-10,o}t.prototype=Object.create(createjs.Container.prototype),t.prototype.showMessage=function(t){if(t){var i=new createjs.Container,n=new createjs.Text(t,"12px Arial","#000000");n.textAlign="center",n.lineWidth=100;var o=n.getBounds(),s=e(100,o.height);i.addChild(s,n),i.y=0-o.height-80,this.addChild(i),s=this,setTimeout((function(){s.removeChild(i)}),5e3)}},t.prototype.showEmote=function(t,i){let n=i+"_"+t;var o=new createjs.Container,s=e(100,60);o.addChild(s),o.y=-140;let r=this.stage.artwork.media.emotes.spriteSheet;client.SpriteSheet.load(r,(function(e){let i=new createjs.Sprite(e);i.spriteSheet.getAnimation(n)?i.gotoAndPlay(n):i.spriteSheet.getAnimation("hamster_"+t)?i.gotoAndPlay("hamster_"+t):i.gotoAndPlay("hamster_smile"),i.setTransform(-30,0,.5,.5),o.addChild(i)})),this.addChild(o),s=this,setTimeout((function(){s.removeChild(o)}),2e3)},client.BalloonContainer=t}(),client=client||{},function(){function t(t,e){createjs.MovieClip.call(this),this.size=e||"lg";let i="/media/bits/critters/"+this.getFilename(t),n=new createjs.Bitmap(i);this.skin=new createjs.Container,this.skin.addChild(n),this.slots={eyes:new createjs.Container,ears:new createjs.Container,head:new createjs.Container,fuzz:new createjs.Container,neck:new createjs.Container,belt:new createjs.Container,mask:new createjs.Container,body:new createjs.Container,pack:new createjs.Container,hand:new createjs.Container,ride:new createjs.Container},this.backs={eyes:new createjs.Container,ears:new createjs.Container,head:new createjs.Container,fuzz:new createjs.Container,neck:new createjs.Container,belt:new createjs.Container,mask:new createjs.Container,body:new createjs.Container,pack:new createjs.Container,hand:new createjs.Container,ride:new createjs.Container},this.forward=[this.backs.ride,this.backs.hand,this.backs.eyes,this.backs.ears,this.backs.head,this.backs.neck,this.backs.fuzz,this.backs.pack,this.backs.belt,this.backs.body,this.backs.mask,this.skin,this.slots.mask,this.slots.body,this.slots.belt,this.slots.pack,this.slots.fuzz,this.slots.neck,this.slots.head,this.slots.ears,this.slots.eyes,this.slots.hand,this.slots.ride];for(var o=0;o<this.forward.length;o++)this.addChild(this.forward[o]);return this}t.prototype=Object.create(createjs.MovieClip.prototype),t.prototype.addItem=function(t){let e=t.itemId,i=t.slot;if(this.slots[i]){if(this.emptySlot(i),t.hasFront){let t="/media/bits/items/fronts/"+this.getFilename(e),n=new createjs.Bitmap(t);this.slots[i].addChild(n)}if(t.hasBack){let t="/media/bits/items/backs/"+this.getFilename(e),n=new createjs.Bitmap(t);this.backs[i].addChild(n)}}return this},t.prototype.emptySlot=function(t){this.slots[t]&&(this.slots[t].removeAllChildren(),this.backs[t].removeAllChildren())},t.prototype.emptyAllSlots=function(){for(let t in this.slots)this.emptySlot(t)},t.prototype.removeItem=function(t){this.emptySlot(t.slot)},t.prototype.getFilename=function(t){return t+"_"+this.size+".png"},client.BitContainer=t}(),client=client||{},function(){function t(t,e){createjs.MovieClip.call(this),this.directionFrames=[0,1,3,3,4,5,5,7],this.items=e||[],this.frame="wait",this.direction=4,this.isMoving=!1,this.isForward=!0,this.hasTail=t.hasTail||!1,this.hasEars=t.hasEars||!1,this.framerate=t.framerate||30,this.scaleX=t.scaleX||1,this.scaleY=t.scaleY||1,this.regX=t.regX||68,this.regY=t.regY||140,this.loop=-1,this.bodyContainer=new createjs.Container,this.feetContainer=new createjs.Container,this.baseContainer=new createjs.Container,this.addChild(this.baseContainer),this.addChild(this.feetContainer),this.addChild(this.bodyContainer),this.skin=new createjs.Container,this.ears=new createjs.Container,this.face=new createjs.Container,this.nose=new createjs.Container,this.feet=new createjs.Container,this.tail=new createjs.Container,this.slots={eyes:new client.SlotContainer,ears:new client.SlotContainer,head:new client.SlotContainer,fuzz:new client.SlotContainer,neck:new client.SlotContainer,belt:new client.SlotContainer,mask:new client.SlotContainer,body:new client.SlotContainer,pack:new client.SlotContainer,hand:new client.SlotContainer,ride:new client.SlotContainer},this.backs={eyes:new client.SlotContainer,ears:new client.SlotContainer,head:new client.SlotContainer,fuzz:new client.SlotContainer,neck:new client.SlotContainer,belt:new client.SlotContainer,mask:new client.SlotContainer,body:new client.SlotContainer,pack:new client.SlotContainer,hand:new client.SlotContainer,ride:new client.SlotContainer},this.forward=[this.backs.ride,this.tail,this.backs.hand,this.backs.eyes,this.backs.ears,this.backs.head,this.backs.neck,this.backs.fuzz,this.backs.pack,this.backs.belt,this.backs.body,this.backs.mask,this.skin,this.ears,this.face,this.slots.mask,this.slots.body,this.slots.belt,this.slots.pack,this.slots.fuzz,this.slots.neck,this.slots.head,this.slots.ears,this.slots.eyes,this.nose,this.slots.hand,this.slots.ride],this.backward=[this.backs.ride,this.backs.hand,this.backs.eyes,this.nose,this.backs.ears,this.backs.head,this.backs.neck,this.backs.fuzz,this.backs.pack,this.backs.belt,this.backs.body,this.backs.mask,this.skin,this.ears,this.face,this.slots.mask,this.slots.body,this.slots.belt,this.slots.pack,this.slots.fuzz,this.slots.neck,this.slots.head,this.slots.ears,this.slots.eyes,this.slots.hand,this.tail,this.slots.ride];for(var i=0;i<this.forward.length;i++)this.bodyContainer.addChild(this.forward[i]);let n=this;client.SpriteSheet.load(t.spriteSheet,(function(t){n.spriteSheet=t,n.skin.sprite=new createjs.Sprite(t,"body4"),n.skin.addChild(n.skin.sprite),n.face.sprite=new createjs.Sprite(t,"face4"),n.face.addChild(n.face.sprite),n.feet.sprite=new createjs.Sprite(t,"feet"),n.feetContainer.addChild(n.feet.sprite),n.hasEars&&(n.ears.sprite=new createjs.Sprite(t,"ears4"),n.ears.addChild(n.ears.sprite)),n.hasTail&&(n.tail.sprite=new createjs.Sprite(t,"tail4"),n.tail.addChild(n.tail.sprite)),n.updateDirection()})),this.timeline.addTween(createjs.Tween.get(this.baseContainer)),this.timeline.addTween(createjs.Tween.get(this.bodyContainer).wait(1).to({y:4}).wait(1).to({y:-12}).wait(1).to({y:-16}).wait(1).to({y:-8}).wait(1)),this.timeline.addTween(createjs.Tween.get(this.feetContainer).wait(2).to({y:-8}).wait(1).to({y:-16}).wait(1).to({y:-6}).wait(1)),this.stop()}t.prototype=Object.create(createjs.MovieClip.prototype),t.prototype.getItemData=function(t){return common.findObjectInArray("itemId",t,this.items)},t.prototype.updateFrame=function(t){"move"===t?(this.frame=t,this.gotoAndPlay(0)):(this.frame=t,this.gotoAndStop(0))},t.prototype.updateDirection=function(t){void 0!==t&&(this.direction=t),this.direction>1&&this.direction<7?this.isForward||(this.isForward=!0,this.updateDepth()):this.isForward&&(this.isForward=!1,this.updateDepth());let e=this.directionFrames[this.direction];this.frame,this.face.sprite&&(this.isForward?(this.face.sprite.gotoAndStop("face"+e),this.face.visible=!0):this.face.visible=!1),this.skin.sprite&&this.skin.sprite.gotoAndStop("body"+e),this.hasTail&&this.tail.sprite&&this.tail.sprite.gotoAndStop("tail"+e),this.hasEars&&this.ears.sprite&&this.ears.sprite.gotoAndStop("ears"+e);for(let t in this.slots)this.slots[t].updateDirection(e);for(let t in this.backs)this.backs[t].updateDirection(e)},t.prototype.updateGear=function(t){for(let t in this.slots)this.slots[t].removeItem();for(let t in this.backs)this.backs[t].removeItem();if(Array.isArray(t)){let e=!1,i=!1;t.forEach((function(t){let n=this.getItemData(t)||{},o=this.slots[n.slot];o&&(o.frame=n.itemId+"/front",o.updateItem(n));let s=this.backs[n.slot];s&&(s.frame=n.itemId+"/back",s.updateItem(n)),n.hideEars&&(e=!0),n.hideNose&&(i=!0)}),this),this.ears.visible=!e,this.nose.visible=!i,this.updateDirection(this.direction)}},t.prototype.updateDepth=function(){if(this.isForward)var t=this.forward;else t=this.backward;for(var e=0;e<t.length;e++){var i=t[e];this.bodyContainer.setChildIndex(i,e)}},client.CritterContainer=t}(),client=client||{},function(){function t(t,e){createjs.Container.call(this)}t.prototype=Object.create(createjs.Container.prototype),client.EffectContainer=t}(),client=client||{},function(){function t(t){createjs.Container.call(this),this.alpha=.5,this.visible=!1,this.image=new createjs.Bitmap(t),this.addChild(this.image)}function e(t){var e=Number(t).toString(16);return 1===e.length?"0"+e:e}createjs.DisplayObject.prototype.getPixel=function(t,e){var i=createjs.DisplayObject._hitTestContext;i.setTransform(1,0,0,1,-t,-e),this.draw(i);var n=i.getImageData(0,0,1,1);return i.setTransform(1,0,0,1,0,0),i.clearRect(0,0,2,2),n},t.prototype=Object.create(createjs.Container.prototype),t.prototype.getHex=function(t,i){var n=this.image.getPixel(t,i);if(n&&n.data){var o=n.data[0],s=n.data[1],r=n.data[2];return n.data[3],function(t,i,n){return""+e(t)+e(i)+e(n)}(o,s,r)}},client.MapContainer=t}(),client=client||{},function(){function t(t,e){createjs.MovieClip.call(this),this.items=e||[],this.frame="wait",this.direction=4,this.isMoving=!1,this.isForward=!0,this.scaleX=t.scaleX||1,this.scaleY=t.scaleY||1,this.regX=t.regX||68,this.regY=t.regY||140,this.loop=-1,this.slots={head:new client.SlotContainer("head"),hair:new client.SlotContainer("hair"),body:new client.SlotContainer("body")},this.animations=t.animations;let i=this;client.SpriteSheet.load(t.spriteSheet,(function(t){i.sprite=new createjs.Sprite(t),i.addChild(i.sprite),i.addChild(i.slots.body),i.addChild(i.slots.head),i.addChild(i.slots.hair),i.updateDirection(i.direction)})),this.stop()}t.prototype=Object.create(createjs.MovieClip.prototype),t.prototype.getItemData=function(t){return common.findObjectInArray("itemId",t,this.items)},t.prototype.updateFrame=function(t){if(t!==this.frame){for(var e in this.frame=t,this.slots)this.slots[e].updateFrame(t);this.updateDirection(this.direction)}},t.prototype.updateDirection=function(t){void 0!==t&&(this.direction=t);let e=this.frame+this.direction;for(var i in this.sprite&&this.sprite.spriteSheet.getAnimation(e)&&this.sprite.gotoAndPlay(e),this.slots)this.slots[i].updateDirection(this.direction)},t.prototype.updateGear=function(t){for(let t in this.slots)this.slots[t].removeItem();Array.isArray(t)&&(t.forEach((function(t){let e=this.getItemData(t)||{},i=this.slots[e.slot];i&&i.updateItem(e)}),this),this.updateDirection(this.direction))},client.MascotContainer=t}(),client=client||{},function(){function t(t){createjs.Container.call(this);let e=t.width,i=t.height;var n=new createjs.Graphics;n.beginFill("black"),n.drawRect(0,0,e,i);var o=new createjs.Shape(n);if(o.alpha=.7,o.on("click",(function(){this.parent.removeChild(this)}),this),t.icon){var s=new client.Image(t.icon);s.regX=80,s.regY=80,s.x=e/2,s.y=120}this.addChild(o,s);var r=new createjs.Text(t.title,"40px Luckiest Guy","#ffffff");r.textAlign="center",r.lineHeight=40,r.lineWidth=320,r.x=e/2,r.y=210,this.addChild(r)}t.prototype=Object.create(createjs.Container.prototype),client.ModalContainer=t}(),client=client||{},function(){function t(t){if(createjs.Container.call(this),t){var e=new createjs.Text(t.n,"12px Arial","#000000");e.textAlign="center",e.lineWidth=100,e.y=15,this.addChild(e),this.x=t.x,this.y=t.y}}t.prototype=Object.create(createjs.Container.prototype),client.NicknameContainer=t}(),client=client||{},function(){function t(t,e,i){createjs.Container.call(this),this.isLocal=i||!1,this.isMoving=!1,this.playerId=t.i,this.critterId=t.c||"hamster",this.speed=5,this.x=t.x,this.y=t.y,this.r=t.r||180,this.direction=common.getDirection(this.r),this.targetX=t.x,this.targetY=t.y;var n=e.getCritter(this.critterId),o=e.getItems();if(!n)return;let s;s="mascot"===n.type?new client.MascotContainer(n,o):new client.CritterContainer(n,o),this.addCritter(s),this.updateGear(t.g);var r=new client.NicknameContainer(t);this.addNickname(r);var a=new client.BalloonContainer(t);this.addBalloon(a)}t.prototype=Object.create(createjs.Container.prototype),t.prototype.addCritter=function(t){this.removeChild(this.critter),this.critter=t,this.critter.scaleX=.5,this.critter.scaleY=.5,this.updateFrame("wait"),this.updateDirection(this.direction),this.addChild(t)},t.prototype.addNickname=function(t){this.nickname=t},t.prototype.addBalloon=function(t){this.balloon=t},t.prototype.updateDirection=function(t){this.direction=t,this.critter.updateDirection(t)},t.prototype.updateFrame=function(t){this.critter.updateFrame(t)},t.prototype.updateGear=function(t){this.critter.updateGear(t)},t.prototype.remove=function(){this.parent.removeChild(this)},t.prototype.showMessage=function(t){this.balloon.showMessage(t)},t.prototype.showEmote=function(t){this.balloon.showEmote(t,this.critterId)},t.prototype.moveTo=function(t,e,i){if(!this.isMoving||this.targetX!==t||this.targetY!==e){void 0===i&&(i=Math.floor(common.calculateAngle(this.x,this.y,t,e))),this.isMoving=!0,this.targetX=t,this.targetY=e;var n=common.getDirection(i);this.updateDirection(n),this.updateFrame("move");var o=common.calculateDistance(this.x,this.y,t,e)*this.speed,s=this;this.tween=createjs.Tween.get(this,{override:!0}).to({x:t,y:e},o,createjs.Ease.linear).call((function(){if(this.isMoving=!1,this.updateFrame("wait"),this.nickname.x=this.x,this.nickname.y=this.y,this.balloon.x=this.x,this.balloon.y=this.y,s.isLocal){var t=new Event("trigger");t.playerId=this.playerId,t.x=this.x,t.y=this.y,s.stage.dispatchEvent(t)}})).addEventListener("change",(function(){if(s.nickname.x=s.x,s.nickname.y=s.y,s.balloon.x=s.x,s.balloon.y=s.y,s.isLocal&&s.isMoving){var t=new Event("moving");t.playerId=s.playerId,t.x=s.x,t.y=s.y,s.dispatchEvent(t)}}))}},client.PlayerContainer=t}(),client=client||{},function(){function t(t,i){if(createjs.Container.call(this),t&&i){this.lastTrigger,this.roomId=t.roomId,this.name=t.name,this.artwork=i||{},this.width=i.width||850,this.height=i.height||480,this.scaleX=1,this.scaleY=1,this.startx=i.startX||Math.floor(this.width/2),this.starty=i.startY||Math.floor(this.height/2),this.focusX=0,this.focusY=0,this.players={},this.sprites=[],this.walls=[],this.triggers=i.triggers||[],this.foreground=new createjs.Container,this.foreground.name="foreground",this.playground=new createjs.Container,this.playground.name="playground",this.background=new createjs.Container,this.background.name="background",this.addChild(this.background),i.navMesh&&(this.navMesh=new client.MapContainer(i.navMesh),this.addChild(this.navMesh)),this.addChild(this.playground),this.addChild(this.foreground);var n=this;this.background.on("click",(function(t){if(n.navMesh){var e=new Event("roomClick");e.x=Math.floor(t.localX),e.y=Math.floor(t.localY),this.stage.dispatchEvent(e)}})),this.playground.addEventListener("tick",e),i.map&&(this.map=new client.MapContainer(i.map,this.triggers),this.addChild(this.map)),this.balloons=new createjs.Container,this.nicknames=new createjs.Container,this.addChild(this.nicknames),this.addChild(this.balloons);var o=new createjs.LoadQueue(!1);o.loadFile({id:"background",src:i.background,crossOrigin:!0}),o.loadFile({id:"foreground",src:i.foreground,crossOrigin:!0}),o.loadFile({id:"layout",src:i.layout,crossOrigin:!0}),o.loadFile({id:"ss",src:i.spriteSheet,type:createjs.Types.SPRITESHEET,crossOrigin:!0}),o.on("complete",(function(t){this.spriteSheet=o.getResult("ss");var e=o.getResult("foreground");e&&this.addImageToTarget(this.foreground,e);var i=o.getResult("background");i&&this.addImageToTarget(this.background,i);var n=o.getResult("layout");n.foreground&&this.addSpritesToTarget(this.foreground,n.foreground),n.playground&&this.addSpritesToTarget(this.playground,n.playground),n.background&&this.addSpritesToTarget(this.background,n.background)}),this),createjs.Sound.removeSound("music"),i.music&&(createjs.Sound.on("fileload",(function(t){createjs.Sound.play("music",{loop:-1})}),this),createjs.Sound.registerSound(i.music,"music"))}}function e(t){t.target.children.sort((function(t,e){return t.y-e.y}))}t.prototype=Object.create(createjs.Container.prototype),t.prototype.addImageToTarget=function(t,e){var i=convertToImgElement(e),n=new createjs.Bitmap(i);t.addChild(n)},t.prototype.addSpritesToTarget=function(t,e){e.forEach((function(e){this.addSpriteToTarget(t,e)}),this)},t.prototype.addSpriteToTarget=function(t,e){var i=new client.SpriteContainer(e,this.spriteSheet);e.name&&this.sprites.push(i),e.isWall&&this.walls.push(i),t.addChild(i)},t.prototype.hideSprites=function(t){t.forEach((function(t){this.hideSprite(t)}),this)},t.prototype.hideSprite=function(t){common.findObjectInArray("name",t,this.sprites).visible=!1},t.prototype.showSprites=function(t){t.forEach((function(t){this.showSprite(t)}),this)},t.prototype.showSprite=function(t){common.findObjectInArray("name",t,this.sprites).visible=!0},t.prototype.addPlayer=function(t){if(this.players[t.playerId]=t,this.playground.addChild(t),this.nicknames.addChild(t.nickname),this.balloons.addChild(t.balloon),t.isLocal){let e=this;this.focus(t.x,t.y-40),t.on("trigger",(function(t){e.trigger(t.x,t.y)})),t.on("moving",(function(t){e.focus(t.x,t.y),e.hideWalls(t.x,t.y)}))}},t.prototype.hideWalls=function(t,e){let i=this.walls.length;for(let n=0;n<i;n++){let i=this.walls[n],o=t-(i.x-i.regX),s=e-(i.y-i.regY);i.hitTest(o,s)?i.visible=!1:i.visible=!0}},t.prototype.getTrigger=function(t,e){if(this.map&&this.triggers){let i=this.map.getHex(t,e);return common.findObjectInArray("hex",i,this.triggers)}},t.prototype.handleTrigger=function(t){},t.prototype.getPlayer=function(t){return this.players[t]},t.prototype.removePlayer=function(t){var e=t.i,i=this.getPlayer(e);i&&(this.balloons.removeChild(i.balloon),this.nicknames.removeChild(i.nickname),i.remove(),delete this.players[e])},t.prototype.updatePlayer=function(t){var e=this.getPlayer(t.i);e&&t.g&&e.updateGear(t.g)},t.prototype.showMessage=function(t){var e=this.getPlayer(t.i);e&&e.showMessage(t.m)},t.prototype.showEmote=function(t){var e=this.getPlayer(t.i);e&&e.showEmote(t.e)},t.prototype.movePlayer=function(t){var e=this.getPlayer(t.i);e&&e.moveTo(t.x,t.y,t.r)},t.prototype.focus=function(t,e){t=t||this.focusX,e=e||this.focusY;var i=t*this.scaleX,n=e*this.scaleY,o=this.stage,s=o.width/2,r=o.height/2,a=this.width*this.scaleX,c=this.height*this.scaleY;a>o.width?this.x=i>s?i<a-s?s-i:o.width-a:0:this.x=0,c>o.height?this.y=n>r?n<c-r?r-n:o.height-c:0:this.y=0,this.focusX=t,this.focusY=e},t.prototype.zoom=function(t){this.scaleX=t,this.scaleY=t,this.focus()},client.RoomContainer=t}(),client=client||{},function(){const t=[{name:"gear",type:"image",image:"/images/icons/gear120.png",action:{showScreen:"gear"}},{type:"widget",image:"/images/widgets/coins.png"}];function e(e){createjs.Container.call(this),t.forEach((function(t){if("image"===t.type){let e=new client.Image(t.image);e.x=760,e.y=410,e.scaleX=.5,e.scaleY=.5,e.on("click",(function(){this.stage.showInventory()}),this),this.addChild(e)}if("widget"===t.type){let i=new client.Widget(t);i.setTransform(10,10,.3,.3),i.updateText(e.world.player.coins),i.on("click",(function(){})),this.addChild(i)}}),this)}e.prototype=Object.create(createjs.Container.prototype),client.ScreenContainer=e}(),client=client||{},function(){function t(){createjs.Container.call(this),this.frame="wait",this.direction=4}t.prototype=Object.create(createjs.Container.prototype),t.prototype.updateItem=function(t){this.removeItem(),this.itemId=t.itemId;let e=this;client.SpriteSheet.load(t.spriteSheet,(function(t){e.sprite=new createjs.Sprite(t),e.addChild(e.sprite),e.updateDirection(e.direction)}))},t.prototype.removeItem=function(){this.removeAllChildren(),delete this.sprite,delete this.itemId},t.prototype.updateFrame=function(t){t&&(this.frame=t,this.updateDirection(this.direction))},t.prototype.updateDirection=function(t){if(void 0!==t&&(this.direction=t),this.sprite){let t=this.frame+this.direction;this.sprite.spriteSheet.getAnimation(t)?(this.sprite.gotoAndPlay(t),this.visible=!0):(this.sprite.gotoAndStop(0),this.visible=!1)}},client.SlotContainer=t}(),client=client||{},function(){function t(t,e){createjs.Container.call(this),this.name=t.name,this.x=t.x,this.y=t.y,this.regX=t.regX,this.regY=t.regY,!1===t.visible&&(this.visible=!1);var i=new createjs.Sprite(e);t.framerate&&(i.framerate=t.framerate),i.gotoAndPlay(t.id),this.addChild(i)}t.prototype=Object.create(createjs.Container.prototype),client.SpriteContainer=t}(),client=client||{},function(){function t(t,e){t&&(createjs.Stage.call(this,t),e&&(this.world=e,this.artwork=e.artwork||{},this.width=document.getElementById(t).width,this.height=document.getElementById(t).height,this.room,this.menu,this.gear,this.beep,this.inventory,createjs.Ticker.framerate=60,createjs.Ticker.on("tick",(function(t){this.update(t)}),this)))}t.prototype=Object.create(createjs.Stage.prototype),t.prototype.listen=function(t){var e=this;t.on("cheerio",(function(){let t=new box.Cheerio(e);e.addChild(t)})),t.on("showShop",(function(){let t=new box.Shop(e);t.setTransform(e.width-270,0,.72,.72),e.addChild(t);let i=new client.Alert("Hello! We are currently developing the new Shop for Box Critters");i.center(e.width,e.height),i.y=20,i.on("click",(function(){e.removeChild(t)})),e.addChild(i)})),t.on("joinRoom",(function(t){var i=e.world.artwork.getRoom(t.roomId);if(i){var n=new client.RoomContainer(t,i);e.addRoom(n),t.playerCrumbs.forEach((function(t){var i=e.isLocalPlayer(t.i),o=new client.PlayerContainer(t,e.artwork,i);n.addPlayer(o)}));let o=new client.ScreenContainer(e);e.addMenu(o)}})),t.on("toggleNicknames",(function(){e.room.nicknames.visible=!e.room.nicknames.visible})),t.on("toggleBalloons",(function(){e.room.balloons.visible=!e.room.balloons.visible})),t.on("addItem",(function(t){let i=this.artwork.getItem(t);if(i){let t=new client.ModalContainer({width:e.width,height:e.height,icon:"/media/icons/"+i.itemId+".png",title:i.name});e.addChild(t)}})),t.on("beep",(function(t){if("warning"===t.style){let i=new client.Alert(t.message);i.center(e.width,e.height),i.y=20,e.addChild(i)}if("info"===t.style){let i=new client.Alert(t.message);e.addChild(i),i.center(e.width,e.height),i.y=20,e.addChild(i)}})),t.on("A",(function(t){var i=new client.PlayerContainer(t,e.artwork);e.room.addPlayer(i)})),t.on("R",(function(t){e.room.removePlayer(t)})),t.on("G",(function(t){e.room.updatePlayer(t)})),t.on("M",(function(t){e.room.showMessage(t)})),t.on("E",(function(t){e.room.showEmote(t)})),t.on("X",(function(t){e.room.movePlayer(t)}))},t.prototype.addRoom=function(t){this.removeChild(this.room),this.room=t,this.addChild(t)},t.prototype.addMenu=function(t){this.removeChild(this.menu),this.menu=t,this.addChild(t)},t.prototype.addBeep=function(t){this.removeChild(this.beep)},t.prototype.isLocalPlayer=function(t){if(this.world)return this.world.isLocalPlayer(t)},t.prototype.showInventory=function(){this.removeChild(this.inventory),this.inventory=new client.Inventory(this.width,this.height,this.world.player),this.addChild(this.inventory)},client.StageContainer=t}();